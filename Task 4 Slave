#include <Arduino.h>

void SPI_SlaveInit() {
  // MISO (PB4) as output
  DDRB |= (1 << PB4);

  // MOSI, SCK, SS as input
  DDRB &= ~((1 << PB3) | (1 << PB5) | (1 << PB2));

  // Enable SPI (Slave mode)
  SPCR = (1 << SPE);
}

void setup() {
  Serial.begin(9600);
  SPI_SlaveInit();
}

void loop() {
  // Wait for data reception
  if (SPSR & (1 << SPIF)) {
    uint8_t received = SPDR;
   
    Serial.println(received);
  }
}
